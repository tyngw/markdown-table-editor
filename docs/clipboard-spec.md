# クリップボード操作仕様（ClipboardManager）

このドキュメントは、Markdown Table Editor のクリップボード操作（コピー・ペースト・カット）に関する仕様をまとめたものです。

## 概要
- 選択セルのコピー・ペースト・カットをサポート
- データ形式はTSV（タブ区切りテキスト）
- セル内容の改行・タブ・引用符も正しく扱う
- テーブルサイズ自動拡張・部分貼り付け対応
- クリップボードAPIのフォールバックも考慮

## コピー仕様
- 選択セル範囲を2次元配列化し、TSV形式でクリップボードに書き込む
- セル内の`<br>`は改行（\n）に変換
- セル内にタブ・改行・引用符が含まれる場合は、Excel/TSV互換のダブルクォートで囲み、内部の"は""にエスケープ
- コピー成功時は行数を表示、失敗時はエラー表示

## ペースト仕様
- クリップボードからTSV形式のテキストを取得し、セルに貼り付け
- セル内の改行（\n）は`<br>`に変換して保存
- 選択セル（lastSelectedCell）を起点に、貼り付け範囲がテーブル外の場合は自動で行・列を拡張
- ヘッダーも自動追加（"Column A"など）
- 貼り付け後は部分的な再描画とスクロール位置復元
- 成功時は貼り付けセル数・拡張行列数を表示

## カット仕様
- コピー後、選択セルを空にする（clearSelectedCellsを呼び出し）

## TSVパース仕様
- Excel/TSV互換のダブルクォート・改行・タブ・エスケープに対応
- 1セル内の改行も正しく復元

## API仕様
- `navigator.clipboard`が使えない場合はtextareaによるフォールバック
- 読み取り不可環境ではエラー表示

## エラー・バリデーション
- 選択セルなし、貼り付け先なし、データなし等はエラー表示
- クリップボードAPI失敗時もエラー表示

## 拡張・注意事項
- 貼り付け時の既存データ上書きは不可避
- 編集中セルへのペーストは未サポート（今後拡張可）
- セル内容の最大長・バリデーションはTableEditor本体仕様に準拠

---
この仕様は `webview/js/clipboard.js` の実装に基づきます。
