# CSVエクスポート仕様（CSVExporter）

このドキュメントは、Markdown Table Editor のCSVエクスポート機能に関する仕様をまとめたものです。

## 概要
- 表示中または編集中のテーブルデータをCSVファイルとしてエクスポート可能
- エクスポート時に文字コード（UTF-8/Shift_JIS等）を選択可能
- ファイル名は編集中ファイル名やタイムスタンプから自動生成
- VSCode拡張側でファイル保存ダイアログを表示

## エクスポート仕様
- ヘッダー行・データ行をすべてCSV出力対象とする
- セル内容は以下のルールでエスケープ：
  - カンマ（,）、ダブルクォート（"）、改行（\n, \r）が含まれる場合はダブルクォートで囲む
  - ダブルクォートは""にエスケープ
  - null/undefinedは空文字列とする
- 改行コードはLF（\n）
- 1行目はヘッダー、2行目以降がデータ

## 文字コード仕様
- デフォルトはUTF-8
- Shift_JIS（sjis）も選択可能（エンコーディング指定は拡張側で処理）
- エクスポート時にエンコーディング選択UI（select#encodingSelect）を参照

## ファイル名仕様
- 編集中ファイル名（拡張子除去）＋.csv
- ファイル名が取得できない場合は `markdown-table-YYYYMMDDhhmmss.csv` 形式

## エラー・バリデーション
- テーブルデータが存在しない場合はエラー表示
- エクスポート失敗時はエラー表示
- VSCode APIが利用不可の場合はエラー

## 拡張・注意事項
- セル内の改行・カンマ・ダブルクォートも正しくエスケープ
- エクスポートは常に全データ（選択範囲のみのエクスポートは未対応）
- エクスポート処理はwebview→拡張機能側にpostMessageで依頼

---
この仕様は `webview/js/csv-exporter.js` の実装に基づきます。
