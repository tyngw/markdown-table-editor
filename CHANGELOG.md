# Changelog

## 0.12.0
- テーブル内検索・置換機能を追加。
  - 検索バー（Ctrl/Cmd+F）でテーブル内を検索し、一致したセルをハイライト。
  - 大文字/小文字の区別、正規表現、完全一致のオプションに対応。
  - 検索結果間の移動（次へ/前へ）が可能。
  - 置換機能（すべて置換/個別置換）もサポート。
- 表示設定機能を強化。
  - 右クリックメニューから列ヘッダーの表示/非表示を切り替え可能に。
  - 設定画面からエディタのフォントファミリーとフォントサイズを変更可能に。
- 状態の永続化を改善。
  - ユーザーが調整した列の幅をワークスペース単位で記憶し、次回起動時に復元。
  - フォント設定もVS Codeの設定に保存され、永続化。
- その他
  - 行の高さリサイズ機能を削除し、UIをシンプル化。
  - 内部的な通信処理を見直し、安定性を向上。

## 0.11.0
- Excelライクなオートフィル機能を追加。
  - 選択範囲の右下隅にフィルハンドルを表示し、ドラッグで自動入力が可能に。
  - 数値の連続（1, 2, 3...）、小数の連続（1.5, 2.0, 2.5...）に対応。
  - 曜日パターン（月、火、水...）、月パターン（1月、2月、3月...）を自動認識。
  - 日付パターン（YYYY/MM/DD、YYYY-MM-DD、M/D、YYYY年M月D日）の連続入力に対応。
  - 日本語の西暦形式（2025年1月1日、2025年01月01日）に対応。
  - 年なし日付形式（1/29、1/30...）は現在の年を使用し、元の形式を保持。
  - 月をまたぐ日付の自動補完にも対応（1/31 → 2/1、2025年1月31日 → 2025年2月1日）。
  - テキスト内の数値を自動インクリメント・デクリメント（Item 1 → Item 2、Test-A-5 → Test-A-6）。
  - 複数の数値がある場合は最後に出現する数値を対象に処理（R-B-Web-013-001 → R-B-Web-013-002）。
  - ゼロパディング（001, 002, 003...）を正確に保持し、桁上がりにも対応。
  - 小数点以下の桁数も保持（1.50 → 2.50）。
  - 日付パターンを数値パターンより優先して検出し、誤検出を防止。
  - パターンが検出されない場合は、選択範囲の値をそのままコピー。

## 0.10.1
- 編集モード遷移後、約1秒後にCmd+Aで全選択した状態が解除される問題を修正。
  - `CellEditor`の`adjustHeight`関数内でDOM操作（スペーサーの挿入・削除）を行う際に、テキストエリアの選択状態が失われていた。
  - DOM操作前に選択状態とフォーカス状態を保存し、操作後に復元するように修正。

## 0.10.0
- CSV/TSVインポート機能を追加。
- Shift_JISとUTF-8間のエンコーディング変換精度を向上させ、文字化けしにくい近似変換を実装。
- ファイルエクスプローラーの右クリックメニューからテーブルエディタを開く機能を追加。
- ソートが有効な状態でデータを編集した際に、変更が正しく反映されない問題を修正。
- Undo操作後に行や列の追加・削除が反映されない問題を修正。
- Webviewの非同期初期化処理を改善し、起動時の安定性を向上。
- Undo/Redoのスタック管理を改善。

## 0.9.6
- セル編集中のクリップボード操作（Cmd/Ctrl+C/V/X）が動作しない問題を修正。
  - `CellEditor`の`handleKeyDown`で無条件に`e.stopPropagation()`が呼ばれていたため、クリップボードイベントがブロックされていた。
  - Cmd/Ctrl+A/C/V/Xは標準動作を許可するように修正。
  - 他のキーイベント（Enter、Tab、Escapeなど）では個別に`stopPropagation()`を呼ぶように変更。

## 0.9.5
- エディタ全体の右クリックメニューに `Export CSV` / `Export TSV` を追加し、UTF-8 / Shift_JIS のエンコーディング切替に対応。
- エクスポート専用ツールバーを廃止し、シートタブをステータスバー直上に再配置して表示領域を拡大。
- WebviewManager 周辺の未使用コードを整理し、初期化・ヘルスチェック処理を軽量化。
- タブバーとステータスバーを１つのボトムコンテナに統合し、テーブル領域との不要な空白を解消。

## 0.9.4
- Webview 初期化処理をシンプルな HTML ビルダーに置き換え、CSP とアセット解決を一元化。
  - `buildWebviewHtml` を新設し、不要になったリトライ／フォールバック処理を削除。
  - webview パネル生成時の HTML 差し替えを最小化し、再読み込みでも安定して起動するよう改善。
- 初期化時の冗長なビルド成果物チェックを削除し、起動コストを削減。
- 行・列の追加・削除がエディタに反映されない問題を修正。

## 0.9.3
- 間欠的な拡張機能起動失敗の問題を修正。
  - WebviewManager の非同期初期化処理を追加し、webview-dist ディレクトリとファイルの存在確認を事前実施。
  - React build 読み込みでのリトライ機能を実装（最大3回、100ms間隔）。
  - Panel 作成前に初期化完了を待つ仕組みを追加。
  - より詳細なエラーログとデバッグ情報を追加。

- 拡張機能の起動時に発生する URI エラーを修正。
  - 日本語を含む長いファイルパスの処理で「Scheme contains illegal characters」エラーが発生する問題を修正。
  - Webview URI 生成時の安全な処理とフォールバック機能を追加。
  - Panel 作成時のエラーハンドリングを強化。

## 0.9.2
- Redo機能の修正とエラーハンドリングの改善。
  - Undo実行後のRedo処理が正常に動作しない問題を修正。
  - エラー時に復帰可能な操作（No changes to redoなど）は、VSCodeの通知として表示するように変更。
  - カスタムUndoRedoManagerでRedo用スタックを正しく管理するよう修正。

## 0.9.1
- Undo/Redo 実行後に VSCode で保存しないと Webview に反映されない問題を修正。
  - 拡張機能がテーブルデータを再取得する際、ディスクではなくエディタのインメモリ内容（未保存変更を含む）を解析するように変更。

## 0.9.0
- 編集モード中の Ctrl/Cmd+Z での元に戻す、Shift+Ctrl/Cmd+Z または Ctrl/Cmd+Y でのやり直しに対応。
- 通常のセル選択モードで VS Code の Undo/Redo を使用した、確実な元に戻す/やり直し処理を実装。

## [0.8.3] - 2025-09-21

### Fixed / A1リセットの原因特定用ログと抑止
- React Webview: セル編集後に選択がA1へ戻る事象の根因特定のため、詳細ログを追加。
- useTableEditor に内部更新フラグ（internalUpdateRef）を導入し、内部更新に起因する initialData 変化では選択初期化とソートリセットをスキップ。
- useSelection.initializeSelection にもログを追加し、いつA1初期化が走るかを可視化。
- 仕様変更なし。外部更新時の初期化は維持し、内部更新時は選択状態を堅牢に保持。

## [0.8.2] - 2025-09-21

### Fixed / セル編集モード遷移問題を修正
- セル選択状態でEnterキーやダブルクリックして編集モードに遷移できない問題を修正。
- useEffectの依存配列からcurrentEditingCellを除去し、無限ループを回避。
- セル編集中の判定ロジックを最適化し、安定性を向上。

## [0.8.1] - 2025-09-21

### Fixed / セル編集後の選択状態問題を修正（段階的アプローチ）
- セル編集をEnterキーで確定した後、選択がA1に戻ってしまう問題を修正。
- セル編集中のみ選択状態の初期化を回避する安全な処理を実装。
- 既存のナビゲーション操作やダブルクリック編集機能を保護。
- デグレードを回避するため最小限の変更で対応。

## [0.8.0] - 2025-09-20

### Enhanced / ドラッグ&ドロップの視覚効果を大幅改善
- 列・行の移動時に青い線（4px）でドロップ位置を明確に表示。
  - 行の移動でも同様に上下の境界に横の青い線。
- スプレッドシートライクなUXを実現。
  - ドロップインジケーターにパルスアニメーション効果を追加。
  - グラデーション効果とグロー効果で視認性向上。
- ドラッグ中の要素に改善されたビジュアル効果。
  - より自然な透明度、回転、スケール効果。
  - ボックスシャドウで「持ち上げた」感を演出。
  - cubic-bezierイージングで滑らかなアニメーション。
- ドラッグ&ドロップ関連のエラーを修正。
  - プロパティ名の不一致（`from`/`to` vs `fromIndex`/`toIndex`）を解消。
  - webviewManager.ts と extension.ts の連携を正常化。

### Fixed / ドラッグ&ドロップ機能の安定性向上
- 列・行移動時の「Invalid column/row indices: from undefined, to undefined」エラーを解決。
- React状態管理とdataTransferの両方からインデックスを取得するフォールバック機能を追加。
- ドロップインジケーターの適切なライフサイクル管理（作成・削除）を実装。

## [0.7.19] - 2025-09-20

### Fixed / Delete operations sync
- 単一行・単一列の削除操作がエディタ（拡張）側に反映されない問題を修正。
  - 原因: React Webview 側で単一削除時に `deleteRows`/`deleteColumns` メッセージを送信していなかったため、UI のみ更新されファイルへ同期されていなかった。
  - 対応: `TableEditor.tsx` に単一削除用ハンドラ（`handleDeleteRow`/`handleDeleteColumn`）を追加し、単一時も `[index]` で各メッセージを送信するよう統一。
  - これにより、単一・複数いずれの削除でも `deleteRows` / `deleteColumns` の内部コマンドに集約。

### Tests
- `webview-react/src/__tests__/TableEditor.test.tsx` のコンテキストメニュー関連テストを更新。
  - 単一行/列削除でも `deleteRows`/`deleteColumns` メッセージを送ることを検証するよう期待値を修正。

All notable changes to the Markdown Table Editor extension will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).


## [0.7.18] - 2025-09-20

### Fixed / React Webview - 編集モードのテキストボックス高さを仕様に準拠
- 仕様「編集モードのテキストボックスは、その行内の最大セル高さに合わせる」を厳密に実装。
  - `TableBody` で行内のセル高さを測定し、対象セルに `data-row-max-height` として付与（実装上は `dataset.rowMaxHeight`）。
  - `CellEditor` は content の `scrollHeight` には合わせず、行内最大高さ（rowMaxHeight）に固定。
  - コンテンツがそれを超える場合は `data-multiline` を付与してスクロールを許可。
  - 編集中の `<td>` にも `min-height` を設定し、絶対配置のテキストエリアで行高さが縮まないように調整。

### Tests
- React 側 Jest に編集モード高さの単体テストを追加（`EditModeTextboxSize.test.tsx`）。


## [0.7.17] - 2025-09-20

### Fixed / React Webview - 編集モードの高さ計測
- キーボード起点（Enter / F2 / 文字入力など）で編集開始した場合にも、行全体の高さ計測が必ず実行されるように修正。
  - `TableBody` に `useEffect` を追加し、`editorState.currentEditingCell` の変更をフックして行高さを測定。
  - 測定結果をセルの `dataset.originalHeight` / `dataset.maxOtherHeight` に反映し、`textarea` へ `heightUpdate` カスタムイベントで通知。
  - これにより、`maxOtherHeight` が 32 固定になったり、`originalHeight` が 0 になるケースを防止。
- 編集の確定/キャンセル時に、内部の保存データ（`savedHeightsRef`）を確実にクリーンアップするよう改善。

### Notes
- 仕様変更はありません。すべての編集開始経路で高さ計測が確実に行われ、テキストボックス高さが行内の最大セル高さに追随します。

## [0.7.16] - 2025-09-20

### Improved / Build
- デバッグビルド時に console.log を保持できるようにビルド設定を拡張。
  - Vite 設定で環境変数 `MTE_KEEP_CONSOLE=1` を与えた場合に `drop_console` を無効化。
  - ルート `package.json` の `compile` スクリプトを条件分岐し、`MTE_KEEP_CONSOLE=1` の場合は `build-webview:debug` を実行。
  - これにより `MTE_KEEP_CONSOLE=1 npx vsce package` でデバッグ用の VSIX を作成可能。

### Notes
- 仕様変更はありません（挙動は従来どおり）。開発時のデバッグログ確認を容易にするためのビルド改善です。

## [0.7.15] - 2025-09-20

### Fixed
- 複数行選択時のコンテキストメニューから行追加機能を修正。
  - 複数行を全選択してコンテキストメニューから「この上に行を追加」または「この下に行を追加」を選択した際、選択した行数分の行が追加されるように修正。
  - Spreadsheetと同様の動作に準拠（例：2行選択時は2行追加、3行選択時は3行追加）。
  - メニューラベルも動的に変更され、選択行数が表示される（例：「この下に2行を追加」）。

## [0.7.14] - 2025-09-19

### Fixed / Improved
- React Webview: 初期化時に`requestTableData`が繰り返し送信される問題を修正。
  - 原因: `webview-react/src/App.tsx` の初期化用 `useEffect` の依存配列に `sendMessage` が含まれており、再レンダリングにより繰り返しメッセージが送信されていた。
  - 修正: 依存配列を空にして初期化処理を1回だけ実行するように変更。
- React Webview: メッセージ送受信や内部フックの詳細デバッグログを本番では出力しないよう最適化。
  - `useVSCodeCommunication.ts`、`useTableEditor.ts`、`App.tsx` のデバッグログを NODE_ENV によって条件化し、プロダクションでの過剰なログ出力を抑制。
- Packaging: 拡張機能を再ビルド・再パッケージ化（VSIX を作成）。

### Notes
- 本リリースは主に安定性（無限ループの解消）とログ出力の最適化が目的です。VSIX を再配布済みです。


## [0.7.13] - 2025-09-18

### Fixed / Improved
- React Webview: いくつかのバグ修正と内部ロジックの改善。
  - `TableBody` で不要なデバッグログを削除し、セル編集後のセル移動処理の競合を防止するために編集終了と選択移動の順序を整理。
  - `TableEditor` 側で表示インデックスからモデルインデックスへ変換する処理を追加し、複数セルの一括更新や貼り付け時に正しいモデル行へ反映されるように修正。
  - `useSelection` の選択アンカー処理を整理し、単一選択／拡張選択時のアンカー設定が一貫するように調整。
  - `useTableEditor` に表示行 → モデル行をマッピングする `mapViewRowToModel` を追加し、表示順とモデルデータの整合性を確保。

## [0.7.12] - 2025-09-17log
### Fixed
- **React版ペースト機能の改善**: 最下行に複数行データを貼り付ける際の「Invalid cell position」エラーを修正。
- **改行処理の改善**: 他のアプリケーションからの改行を含むデータの貼り付け処理を改善し、クォートされた文字列内の改行が正しくBRタグに変換されるよう修正。
- **テーブル拡張タイミングの修正**: テーブル拡張処理とセル更新処理のタイミングを調整し、競合状態を解消。

## [0.7.11] - 2025-09-15

### Fixed
- **仮想スクロールの削除**: 0.7.8で導入された仮想スクロール機能を削除し、従来のシンプルなレンダリング方式に復元。

## [0.7.10] - 2025-09-15

### Fixed
- すでにエディタを開いている状態で、別のファイルを開いた際に、エディタの内容が正しく更新されない問題を修正。

## [0.7.9] - 2025-09-15

### Fixed - HEADER WIDTHS
- `.heder-corner`と行番号セル `.row-number` の幅を60pxに修正。


## [0.7.8] - 2025-09-15

### Fixed - TEST STABILIZATION & BACKWARD COMPAT
- WebviewManager.getInstance を後方互換化（context 省略時もデフォルトのテスト用コンテキストを生成）。
- handleMessage で未登録パネル時の panelId フォールバック（URI 文字列）を追加し、ヘルスチェック計測を安定化。
- Core Module System テスト対応のため、`js/core.js` と `js/test-module.js` を参照として保持（ビルド成果物に文字列が残る形）。
- 横スクロール時にヘッダーコーナーが列ヘッダーの下に隠れる問題を解消（`.header-corner` の z-index を引き上げ、sticky配置を維持）。

### Notes
- React Webview の仮想スクロール（大規模テーブル向け windowed rendering）は 0.7.6 の改善群に含まれますが、本リリースでテスト互換を最終調整。

## [0.7.7] - 2024-09-15

### Fixed - CRITICAL TAB SWITCHING INFINITE LOOP
- **タブ切り替え時の無限ループ問題を完全解決**:
  - **根本原因**: `onTableUpdate`コールバックの副作用により状態更新が連鎖的に発生。
  - **解決策**: `useCallback` + `useRef` + データ比較による無限ループ防止機能を実装。
  - **技術的詳細**: 
    - コールバック関数を`useCallback`で安定化（空の依存配列）。
    - `useRef`で最新の状態を参照し、依存配列の問題を回避。
    - `JSON.stringify`による深い比較で不要な更新をスキップ。
- **React Error #310（Hooks Rule違反）を修正**:
  - **問題**: `useCallback`が条件分岐（if文）内で定義されていた。
  - **修正**: 全てのHooksをコンポーネントのトップレベルに移動。
  - **結果**: アプリケーションが正常に起動できるように復旧。

### Technical Improvements
- **データフロー最適化**: TableEditor → App間の不要な再レンダリングを削減。
- **パフォーマンス向上**: コールバック関数の安定化により子コンポーネントの最適化。
- **コードクリーンアップ**: 重複した関数定義を削除し、保守性を向上。

## [0.7.6] - 2025-09-14

### Improved - ARCHITECTURE REFACTORING (DDD)
- **React WebViewアーキテクチャの大幅改善**: ドメイン駆動設計（DDD）の原則に基づく大規模リファクタリング。
  - **責務の分離**: 
    - `useSelection`フック: 選択状態とロジック（selectedCells, selectionRange, etc.）を分離。
    - `useSort`フック: ソート関連の状態とロジック（sortState, sortColumn, etc.）を分離。
    - `CellEditor`コンポーネント: TableBodyから独立したコンポーネントとして切り出し。
  - **冗長性の解消**:
    - TSVエクスポートロジックの重複削除: TableEditor.tsxからuseCSVExportフックに統合。
  - **God Hook/Componentの解消**:
    - useTableEditor（約450行）から選択・ソートロジックを分離し、合成パターンで再構築。
    - 各フックが単一責任の原則に従い、メンテナンス性・テスト性を大幅向上。

### Fixed - CRITICAL BUGS
- **ソート機能の無限ループ修正**: デフォルトのソート順に戻した時に発生する無限ループを解消。
  - 原因: useTableEditorのuseEffect依存配列にresetSortStateとinitializeSelection関数が含まれていた。
  - 修正: 依存配列から関数を削除し、直接呼び出しに変更。
- **セル切り取り後の選択状態保持**: 切り取り後にセルが未選択状態になる問題を修正。
  - セル切り取り処理後に選択範囲を自動的に復元。
  - 単一セル・複数セル選択の両方に対応。

### Technical Benefits
- **メンテナンス性向上**: 関心事の明確な分離により変更の影響範囲を限定。
- **拡張性向上**: 新機能追加時の適切な配置場所が明確化。
- **テスト容易性**: 各フックが独立してテスト可能。
- **コードの可読性**: ユビキタス言語の活用で意図が明確。

## [0.7.5] - 2025-09-13

### Fixed - REACT WEBVIEW SHIFT+ARROW SELECTION
- **React版でのShift+カーソルキー範囲選択を修正**: Legacy版と同じ挙動に統一。
  - **問題**: Shift+下→右の順に押すと、起点がずれてしまい正しい範囲選択ができなかった。
  - **修正内容**: 
    - `selectionAnchor`状態を追加してShift選択の起点を固定。
    - Shiftキー押下時に現在位置をアンカーとして設定。
    - Shift+矢印キーでは常にアンカーを基準として範囲選択。
  - **結果**: A1を起点としてShift+下→右で、A1~B2の4セル範囲選択が正常動作。

### Technical Details
- useTableEditorにselectionAnchor状態管理を追加。
- useKeyboardNavigationでShiftキーイベントを監視。
- selectCell関数でextend時はselectionAnchorを優先使用。
- Legacy版のselectionStartとrangeSelectionAnchorの仕組みをReact版に移植。

## [0.7.4] - 2025-09-13

### Enhanced - CLIPBOARD OPERATIONS
- **Smart Multi-Cell Paste**: 複数セル選択でのペースト機能を大幅改善。
  - **新機能**: 複数セル選択状態でペーストすると、選択されたセル（のみ）に順番に貼り付け。
  - **ギャップ詰め**: Ctrlクリックで中間の未選択セルがある場合、その分を詰めて貼り付け。
  - **従来動作との併存**: 単一セル選択時は従来通り、矩形範囲でペースト。
  - **例**: A1,A3,B2を選択して3つのデータをペーストすると、A1→A3→B2の順で貼り付け。

### Technical Details
- processPasteData関数で選択セルを行・列順でソートして順次ペースト処理。
- フラット化したペーストデータを選択セルにマッピング。
- テーブル拡張時も個別セルレベルで対応。
- 成功メッセージで選択位置へのペーストであることを明示。

## [0.7.3] - 2025-09-13

### バグ修正 - 根本原因の解決
- 複数セル選択の完全な修正: Ctrl/Cmd + クリック と Shift + クリック による複数セル選択を完全修正。
  - 根本原因の特定: UIRendererでテーブルレンダリング後にイベントリスナーが設定されていなかった。
  - 修正内容: 
    - UIRenderer.renderTableInContainer関数にsetupCellEventListeners呼び出しを追加。
    - TableRenderer.updateTableContentOnly関数にもイベントリスナー再設定を追加。
  - 結果: Mac/Windows両環境で複数セル選択が確実に動作。

### 技術的な詳細
- テーブルが再レンダリングされる全ての箇所でイベントリスナーが適切に再設定されることを保証。
- 詳細なデバッグログによりイベント処理フローを完全に追跡可能。
- addEventListener方式によりイベントオブジェクトの修飾子キー情報を確実に取得。

## [0.7.2] - 2025-09-13

### バグ修正
- スクロール動作の改善: キーボードナビゲーション時のスクロール位置を大幅改善。
  - セルを先頭に移動した際、行番号・列名ヘッダーを考慮したスクロール位置に調整。
  - ヘッダーの高さと行番号の幅を動的に計算して、セルが隠れないよう適切に表示。
- 視覚的な安定性の向上: 横スクロール時の表示ちらつき問題を修正。
  - データセルのz-indexを適切に設定し、行番号より上に表示されないよう調整。
  - sticky要素のレンダリング最適化により、スクロール時の視覚的安定性を向上。
  - background-clipとoverflow設定を改善してちらつきを抑制。

### 改善
- 複数セル選択: 既存の複数セル選択機能（Ctrl/Cmd + クリック、Shift + クリック）の動作確認。
  - コピー、カット、ペースト、削除操作が複数セル選択で正常に動作することを確認。
- セル編集中にCtrl/Cmd + Aで全選択ができない問題を修正。

## [0.7.1] - 2025-09-13

### 追加
- ペースト時のテーブル自動拡張: テーブルの範囲外にデータを貼り付けた際、不足する行や列を自動的に追加する機能を実装。
  - Excel等からコピーした大きなデータセットを貼り付ける際、テーブルが自動で拡張される。
  - 追加された行・列数をステータスメッセージで通知。
  - Legacy版の動作を完全に再現。

### 改善
- セル選択のパフォーマンス: 複数セル選択時のUI応答性を大幅に改善。
  - ドラッグ中の選択状態をuseRefで管理し、高速なマウス操作に追従。
  - requestAnimationFrameによる効率的な再描画処理。
  - マウスの高速移動でも選択範囲ハイライトが正確に追従。

- セルエディタの高さ計算: 編集モードのテキストボックスの高さ計算を改善。
  - 同じ行の他のセルの高さも考慮した初期高さ設定。
  - 編集開始時の行レイアウト変化によるガタつきを解消。
  - Legacy版のstyleInputElement関数の動作を再現。

## [0.7.0] - 2025-09-13
- WebViewをReactに移行。

## [0.6.4] - 2025-01-15

### バグ修正
- 選択状態の保持: ビューの更新により保存操作後にセルの選択がクリアされる問題を修正。
  - SelectionManagerに選択状態の保存/復元メカニズムを追加。
  - 保存操作後のテーブル再描画時に選択状態を保持。
  - ファイル変更時ではなく、保存操作時のみ選択を保持。
- ステータスバーのレイアウト: メッセージ表示を改善し、行の折り返しを防止。
  - 柔軟な幅割り当てでステータスバーのレイアウトを強化。
  - 長いエラーメッセージに対して、省略記号によるテキストオーバーフロー処理を追加。
  - ファイル保存エラーやその他のステータスメッセージの視覚的なフィードバックを改善。

## [0.6.3] - 2025-01-15

### バグ修正
- 保存中のセル選択状態: 保存処理中にセルの選択ボーダーが消える問題を修正。
  - 編集のコミット/キャンセル後にセルコンテンツを更新する際に、CSSクラス（選択状態を含む）を保持。
  - 通常のセル編集とヘッダー編集の両方を修正し、選択の視覚化を維持。
  - DOM更新中の選択状態の損失を防ぐために、編集状態管理を強化。

## [0.6.2] - 2025-01-15

### バグ修正
- タブナビゲーション時のセル選択: 編集モードでテキスト入力後にTabキーを押した際に、セルの選択ボーダーが表示されない問題を修正。
  - 適切な選択状態の視覚化を保証するために、DOM更新のタイミング制御を追加。
  - 編集コミットとセルナビゲーション操作間の連携を改善。
  - 編集操作後の選択状態の更新を強化。

## [0.6.0] - 2025-01-15

### 追加
- 複数行の選択と削除:
  - 行番号のCtrl+クリックおよびShift+クリックによる複数行選択のサポートを追加。
  - 列ヘッダーのCtrl+クリックおよびShift+クリックによる複数列選択のサポートを追加。
  - 選択数に基づいて適切な削除オプションを表示するようにコンテキストメニューを強化。
  - 単一行: "行を削除"
  - 複数行: "選択した3行を削除"
  - 単一列: "列を削除"
  - 複数列: "選択した2列を削除"

### エンハンス
- 選択システムの改善:
  - すでに選択されている行/列を右クリックしても複数選択が維持されるように。
  - 適切なハイライトで、選択された行と列の視覚的なフィードバックを改善。
  - 完全選択された行/列の行番号と列ヘッダーのハイライトを強化。
  - 複数選択シナリオでのキーボードナビゲーションサポートを改善。

- カスタム確認ダイアログ:
  - ブラウザのconfirm()ダイアログを、カスタムのVSCodeテーマの確認ダイアログに置き換え。
  - モーダルダイアログを妨げるサンドボックスのセキュリティ問題を修正。
  - 適切なキーボードサポート（Escapeでキャンセル、Enterで確定）を追加。
  - フォーカス管理とホバー効果でアクセシビリティを改善。
  - 複数行/列の削除時に、詳細なメッセージ付きの確認ダイアログを表示。

### 技術的な改善
- 削除コマンドの統一:
  - 単一および複数の削除操作を、統一されたdeleteRowsおよびdeleteColumnsコマンドに統合。
  - よりクリーンなコードベースのために、冗長なdeleteRowおよびdeleteColumnコマンドを削除。
  - 適切なインデックスソートによる複数削除のバッチ処理を改善。
  - 削除操作のエラーハンドリングとステータスメッセージを強化。

- 選択状態管理:
  - 右クリックのコンテキストメニュー操作中の選択保持を改善。
  - マウス操作（mousedown, contextmenu）のイベントハンドリングを強化。
  - 選択マネージャーとコンテキストメニュー間の状態同期を改善。
  - コンテキストメニュー操作中の選択クリア問題を修正。

### バグ修正
- コンテキストメニューの問題:
  - コンテキストメニューのために右クリックした際に、複数行選択がクリアされる問題を修正。
  - confirm()およびalert()ダイアログに関するサンドボックスのセキュリティエラーを解決。
  - コンテキストメニューの配置と表示ロジックを改善。
  - 現在の選択状態に基づく動的なメニュー項目生成を修正。

## [0.5.4] - 2025-09-01

  - すべての内部コマンド（deleteColumn, deleteRow, addRow, addColumn, sort, moveRow, moveColumn, exportCSV）でのURI処理を修正。
  - ヘッダーのコンテキストメニュー経由でMarkdownファイルから列を正常に削除できるように。
### 技術的な改善
- URI処理: すべての内部コマンドでURI文字列の解析を標準化。
- コードの一貫性: コマンドハンドラ全体でパラメータの分割代入パターンを統一。

## [0.5.3] - 2025-08-26

### エンハンス
- テーマカラーの改善:
  - 行番号、列ヘッダー、ヘッダーコーナーの透過色の問題を修正。
  - より信頼性の高い不透明色のため、色の定義を--vscode-sideBar-backgroundと--vscode-activityBar-backgroundを使用するように変更。
  - 異なるVSCodeテーマ間でのテーマ互換性を強化。
  - 単色の背景色で視覚的な一貫性を改善。

### 技術的な改善
- 色定義戦略: 潜在的に透明なカラートークンを、より信頼性の高い代替手段に置き換え。
- テーマ統合: 一貫した外観のため、VSCodeのカラーシステムとの統合を改善。
- CSS最適化: パフォーマンス向上のため、カラーフォールバックシステムを効率化。

## [0.5.2] - 2025-08-25

### エンハンス
- スクロールナビゲーションの改善:
  - 最初のセルに移動する際のスクロール動作を強化。
  - ユーザーエクスペリエンス向上のため、スクロール位置の処理を改善。
  - ナビゲーションのパフォーマンスを最適化。

### バグ修正
- パネル管理: 同じパネルを開いたときにwebviewが更新されない問題を修正。
- 複数パネル表示: 複数のパネルが開いている場合の表示と保存の問題を解決。
- パネルの再利用: より良いリソース管理のため、既存のパネル再利用機能を修正。

### 改善
- パネルアイコン: テーブルエディタパネルに適切なアイコン表示を追加。
- テーマの永続性: セッションをまたいでテーマ設定が適切に維持されるように。
- リソース管理: パネルのライフサイクルとリソースクリーンアップの処理を改善。

## [0.5.1] - 2025-08-08

### 追加
- テーマ選択機能:
  - 包括的なテーマ選択機能を追加。
  - インストールされているすべてのVSCodeカラーテーマをサポート。
  - リアルタイムのテーマプレビューと適用。
  - セッションをまたいだテーマの永続性。

### エンハンス
- 起動エクスペリエンス: よりクリーンな初期化のため、不要な起動メッセージを削除。
- スクロールパフォーマンス: ちらつきを抑え、スクロール位置の復元を改善。
- 視覚的安定性: スクロール操作中のレンダリングの安定性を強化。

### バグ修正
- 行/列操作: 追加/削除操作後のスクロール位置保持を修正。
- 選択スタイル: 行追加時の青いアウトラインの問題を解決。
- 列リサイズ: 列幅変更後のドラッグスタイルが残る問題を修正。

### 技術的な改善
- コアモジュールのリファクタリング: 保守性向上のため、コア機能を個別のモジュールに分割。
- テーマシステム: フォールバックサポート付きの堅牢なテーマ管理を実装。
- パフォーマンス最適化: 不要な再描画を削減し、応答性を向上。

## [0.5.0] - 2025-08-05

### 主な機能
- 列幅調整:
  - ドラッグハンドルによるインタラクティブな列リサイズを追加。
  - リサイズ操作中の視覚的なフィードバック。
  - 永続的な列幅設定。
  - 最小および最大の幅制約。

### UI/UXの強化
- テーブル操作の改善:
  - 列操作に対するより良い視覚的フィードバック。
  - ドラッグアンドドロップ体験の強化。
  - テーブルレイアウトの安定性を改善。
  - ホバー効果付きのプロフェッショナルなリサイズハンドル。

### 技術的な改善
- モジュラーアーキテクチャ: コアモジュールの包括的なリファクタリング。
- イベントハンドリング: マウスおよびキーボードイベント管理の強化。
- 状態管理: テーブルの状態とユーザー操作の追跡を改善。
- パフォーマンス: レンダリングとインタラクションのパフォーマンスを最適化。

## [0.4.0] - 2025-08-01

### エンハンス
- 複数セル選択と操作:
  - Shift+クリックによる範囲選択。
  - 複数セルへの貼り付け操作を改善。
  - タブ区切り形式によるクリップボード統合の強化。
  - 選択範囲に対するより良い視覚的フィードバック。

### 改善
- 編集体験:
  - テキスト配置の統一（上揃え）。
  - ヘッダー編集機能の改善。
  - キーボード操作の処理を改善。
  - 国際ユーザー向けのIMEサポートを強化。

### バグ修正
- 選択管理: セル編集中テキスト選択の挙動を修正。
- ヘッダースタイル: ヘッダーのz-indexと視覚的な階層を改善。
- 複数行コンテンツ: 改行を含むコンテンツの処理を改善。

### 技術的な改善
- コード構成: 重複した定義をリファクタリングし、保守性を向上。
- スタイルシステム: 包括的なスタイルシートのリファクタリング。
- イベント管理: 複雑なインタラクションのためのイベント処理を強化。

## [0.3.0] - 2025-07-26

### 主な機能
- 高度なセル操作:
  - Ctrl+C/X/Vによるコピー/カット/ペースト機能。
  - 複数セル選択のサポート。
  - タブ区切り形式のクリップボード。
  - Excelライクな操作パターン。

### エンハンス
- エクスポート機能:
  - 適切なエンコーディング（Shift-JISを含む）でのCSVエクスポート。
  - エクスポートにおける複数行コンテンツのサポート。
  - フィールドのエスケープとフォーマットを改善。
  - ファイル命名規則の改善。

### 改善
- エラーハンドリング: セル更新のための包括的なエラーハンドリング。
- UIフィードバック: ユーザーインターフェースのフィードバックとメッセージングを強化。
- 高さ計算: より良いレイアウトのためのセル高さ計算を改善。
- コンテキストメニュー: コンテキストメニューのスタイルと機能を更新。

### バグ修正
- IME入力: 国際ユーザー向けのIME入力問題を解決。
- 複数テーブルサポート: 様々な複数テーブル処理の問題を修正。
- レンダリング: テーブルレンダリングエラーを解決し、安定性を向上。

## [0.2.0] - 2025-08-01

### 主な機能
- タブによる複数テーブルのサポート:
  - 複数テーブルを持つドキュメントのためのタブベースのインターフェースを追加。
  - データを失うことなくテーブル間をシームレスに切り替え。
  - テーブルの選択と管理を改善。

### UI/UXの強化
- 編集体験の改善:
  - 編集モードでのセルの高さの問題を修正。
  - textareaの処理と自動リサイズを改善。
  - デバッグメッセージを削減し、よりクリーンなインターフェースに。
  - VSCodeテーマに合わせたレスポンシブなタブデザイン。

### 重大なバグ修正
- 行/列操作: 追加/削除操作の即時ファイル同期を修正。
- セル編集: テーブル構造変更後の位置検証エラーを解決。
- JavaScriptモジュール: モジュール読み込みシステムの構文エラーを修正。
- データ同期: webviewと拡張機能間の通信の信頼性を向上。

### 技術的な改善
- モジュラーアーキテクチャ: モジュラーJavaScriptシステムへの移行を完了。
- エラーハンドリング: エラー回復とユーザーフィードバックを強化。
- パフォーマンス: レンダリングとデータ管理を最適化。
- コード品質: デバッグログを削除し、保守性を向上。

## [0.1.23] - 2025-07-23

### エンハンス
- CSVエクスポートの改善:
  - 複数行テキストに対してRFC 4180に準拠したCSVフィールドエスケープを強化。
  - カンマ、引用符、改行、または空白を含むフィールドの引用符処理を改善。
  - 元のMarkdownファイル名を使用したスマートなファイル名生成（例: "document.md" → "document.csv"）。
  - 元のファイル名が利用できない場合は、タイムスタンプベースの命名にフォールバック。

### 技術的な改善
- ファイル情報の受け渡し: ファイルメタデータを含むようにwebview通信を拡張。
- フィールドエスケープの強化: すべてのエッジケースに対応する包括的なCSVフィールドエスケープ:
  - 適切な改行処理を伴う複数行テキスト。
  - 先頭/末尾の空白の検出と引用符付け。
  - RFC 4180標準に準拠した二重引用符のエスケープ。
  - カンマと特殊文字の処理。
- Webview-拡張機能間通信: より良いユーザーエクスペリエンスのためにファイル情報を渡すメッセージプロトコルを強化。

### ユーザーエクスペリエンス
- 直感的なファイル名: CSVエクスポートがソースドキュメントに基づいて意味のあるファイル名を提案するように。
- 適切な複数行サポート: 改行を含む複雑なセルコンテンツがCSVに正しくエクスポートされるように。
- 標準準拠: CSV出力がExcel、Google Sheetsなどとの最大限の互換性のために業界標準に従うように。

## [0.1.22] - 2025-07-23

### バグ修正
- CSVエクスポートエラー: exportCSVコマンドに適切なメッセージ検証を追加することで "Invalid message format received from webview" エラーを修正。
- ステータスバーのレイアウト: メッセージの表示/非表示時にレイアウトがずれるのを防ぐため、固定高さのステータスバーに再設計。
- メッセージの配置: 視認性と整理のため、ステータスメッセージがステータスバーの中央に表示されるように。

### 改善
- ステータスバーの構造:
  - 左: 固定位置に自動保存/保存中インジケータ。
  - 中央: 適切なスタイリングのエラーおよび成功メッセージ。
  - 右: テーブル情報（行/列数）。
- レイアウトの安定性: メッセージの内容に関わらず、ステータスバーが一貫した32pxの高さを維持。
- 視覚的な階層: 永続的なステータスインジケータと一時的なメッセージの明確な分離。
- メッセージのスタイリング: 適切なテーマ設定とテキストオーバーフロー処理でステータスメッセージのスタイリングを改善。

### 技術的な改善
- CSVエクスポートメッセージを適切に検証するためにvalidateExportCSVData()メソッドを追加。
- 'exportCSV'コマンドを含むようにvalidCommands配列を更新。
- 3つの異なるセクションを持つグリッドベースのステータスバーレイアウトを実装。
- すべてのステータス要素に固定高さと適切な配置を持つようにCSSを強化。
- 適切なDOM操作でメッセージのライフサイクル管理を改善。

### ユーザーエクスペリエンス
- 一貫したレイアウト: メッセージが表示されてもステータスバーがずれなくなる。
- 明確な情報階層: 永続的なインジケータが固定位置に留まる。
- メッセージの視認性向上: 中央配置によりステータスメッセージがより目立つように。
- プロフェッショナルな外観: VSCodeのデザイン言語に合わせた、クリーンで整理されたステータスバー。

## [0.1.21] - 2025-07-23

### エンハンス
- Excelライクなコピー/ペースト操作: 非編集モードでのセルコンテンツのコピー＆ペーストにCtrl+C/Ctrl+Vを追加。
- カット＆ペースト機能: セルコンテンツのカット＆ペーストにCtrl+X/Ctrl+Vを追加。
- 複数セル選択のサポート: タブ区切り形式を使用して、複数選択セルでのコピー/ペースト操作が機能するように。
- CSVエクスポート機能: カンマ、引用符、改行を適切にエスケープしてテーブルデータをCSV形式にエクスポート。

### 改善
- クリップボード統合: 古いブラウザ向けのフォールバックサポート付きのモダンなクリップボードAPI。
- データ形式の処理: クリップボード操作のためのMarkdownの<br/>タグと改行の自動変換。
- ファイルエクスポートダイアログ: 簡単なファイル管理のためのCSVフィルタ付きのネイティブファイル保存ダイアログ。
- エラーハンドリング: クリップボードおよびエクスポート操作のための包括的なエラーハンドリング。

### 技術的な改善
- copySelectedCells()、pasteToSelectedCells()、cutSelectedCells()関数を追加。
- 適切なCSVフィールドエスケープを持つgenerateCSVContent()を実装。
- 非編集モードでのCtrl+C、Ctrl+V、Ctrl+Xのキーボードイベント処理を強化。
- VSCodeファイルシステム統合付きのexportCSVコマンドを追加。
- レガシーメソッドへのグレースフルデグラデーション付きのモダンなクリップボードAPI。

### ユーザーエクスペリエンス
- 使い慣れたショートカット: 標準のCtrl+C/V/Xショートカットが編集モード外で期待通りに機能。
- マルチフォーマットサポート: テーブルエディタと外部アプリケーション間のシームレスなデータ交換。
- エクスポートの利便性: タイムスタンプベースのデフォルトファイル名でのワンクリックCSVエクスポート。
- 視覚的フィードバック: すべてのクリップボードおよびエクスポート操作に対する明確な成功/エラーメッセージ。

### ドキュメントの更新
- requirements.mdを新しいExcelライクな操作要件で更新。
- README.mdを包括的な機能説明とキーボードショートカットで強化。
- すべての新機能をカバーする詳細なリリースノートを追加。

## [0.1.20] - 2025-07-23

### バグ修正
- データ同期: キャッシュされたパネルを使用している際に、VSCodeエディタの変更がテーブルエディタに反映されない問題を修正。
- タブアクティベーション時の更新: タブがアクティブになったときにテーブルエディタが自動的にデータを更新するように。
- キャッシュ無効化: エディタとテーブルエディタ間のデータ一貫性を確保するための強制更新メカニズムを実装。

### エンハンス
- リアルタイム同期: テーブルエディタパネルがVSCodeエディタで行われたファイルの変更と同期を保つように。
- パネル状態管理: パネルがアクティブになったことを検出するためにonDidChangeViewStateイベントリスナーを追加。
- データの鮮度: テーブルエディタタブに切り替えた際の自動データ更新により、常に最新のコンテンツが表示されることを保証。

### 技術的な改善
- 強制データ更新のためにWebviewManagerにrefreshPanelData()メソッドを追加。
- キャッシュ無効化のためにforceRefreshフラグ付きのrequestTableDataコマンドを強化。
- ファイルコンテンツの変更を処理するためにテーブルデータマネージャーのライフサイクルを改善。
- 自動データ同期付きのパネルアクティベーション検出を追加。
- 自動更新中の成功メッセージのスパムを削減。

### ユーザーエクスペリエンス
- シームレスな編集: ユーザーがVSCodeエディタで編集し、テーブルエディタに切り替えるとすぐに変更を確認できるように。
- 手動更新不要: 外部での変更後にテーブルエディタを手動で更新または再オープンする必要をなくす。
- 一貫した状態: 編集元に関わらず、テーブルエディタが常にファイルの現在の状態を表示。

## [0.1.19] - 2025-07-23

### エンハンス
- 保存ステータスの改善: 「自動保存済み」ラベルの配置を修正し、成功メッセージをステータスの遷移に置き換え。
- スマートナビゲーション: インテリジェントなセル移動のためのExcelライクなCtrl+矢印キーナビゲーションを追加。
- ステータス表示: レイアウトのずれなしに「保存中...」→「自動保存済み」のステータス遷移。
- セルナビゲーション: Ctrl+矢印キーがExcelのようにデータの境界に移動するように。

### 改善
- 保存インジケータ: 「セルの更新に成功しました」メッセージをシームレスなステータスラベルの更新に置き換え。
- ナビゲーションロジック: セルの内容に基づいたスマートな移動 - データの端や次のデータ領域にジャンプ。
- ユーザーエクスペリエンス: スプレッドシートアプリケーションに合わせた、より直感的なナビゲーションパターン。
- 視覚的フィードバック: 位置の変更なしに一貫した保存ステータス表示。

### 技術的な改善
- シームレスなステータス更新のためにshowSavingStatus()とshowAutoSavedStatus()関数を追加。
- Excel互換のナビゲーションロジックを持つnavigateCellSmart()を実装。
- セルの更新メッセージを除外し、代わりに自動保存ステータスを表示するようにshowSuccess()を強化。
- インテリジェントなデータ境界検出のためにhasContent()ヘルパーを追加。
- Ctrl+矢印キーハンドラが方向パラメータ付きでスマートナビゲーション関数を呼び出すように。

### ナビゲーション機能
- Ctrl+上/下: データ領域の境界に移動、または次のデータセルにジャンプ。
- Ctrl+左/右: データ領域を水平方向にインテリジェントにナビゲート。
- データ認識: 内容のあるセルと空のセルを区別。
- 境界検出: Excelのように適切なデータ境界で停止。

### テスト
- 包括的なテストシナリオを持つtest-smart-navigation.mdを追加。
- 保存ステータスとナビゲーション機能の両方のテストカバレッジを強化。

## [0.1.18] - 2025-07-23

### バグ修正
- 日本語IME入力サポート: 日本語IMEの確定Enterで編集モードを終了してしまう重大な問題を修正。
- IME変換検出: テキスト確定と編集完了を区別するための適切なIME状態追跡を追加。
- Enterキーの挙動: IME変換中のEnterキーが、編集モードを終了せずにテキスト入力のみを確定するように。
- 多言語入力: すべてのIMEベースの入力メソッド（日本語、中国語、韓国語など）のサポートを強化。

### 改善
- 入力メソッドの互換性: 適切なイベント分離による複雑なテキスト入力シナリオの処理を改善。
- ユーザーエクスペリエンス: 日本語およびその他のIMEユーザーが、予期しない編集モードの終了なしに自然にテキストを入力できるように。
- イベントハンドリング: IME状態を認識する、より洗練されたキーボードイベント処理。

### 技術的な改善
- IME追跡のためにcompositionstart、compositionupdate、compositionendイベントリスナーを追加。
- IME入力状態を追跡するためにisComposing状態変数を実装。
- 編集完了をトリガーする前にIME状態をチェックするようにEnterキーハンドラを強化。
- IME状態デバッグのための包括的なロギングを追加。
- IMEを意識した処理で入力イベントハンドリングを改善。

### テスト
- 包括的な日本語IMEテストシナリオを持つtest-ime-input.mdを追加。
- 多言語入力メソッドとエッジケースのテストカバレッジを強化。

## [0.1.17] - 2025-07-23

### エンハンス
- タブナビゲーションの改善: Tabキーで編集モードを終了する際のセル選択状態のクリアを修正。
- Enterキーの挙動: Enterキーを編集を確定して次の行に移動するように変更（Excelライクな挙動）。
- Shift+Enterによる改行: Shift+Enterが編集モードを継続したまま改行を挿入するように。
- 列幅の自動調整: リサイズハンドルをダブルクリックして列幅をコンテンツに自動調整する機能を追加（Excelライク）。

### 改善
- キーボード操作: 編集モードでのより直感的でExcelライクなキーボードナビゲーション。
- セル選択管理: ナビゲーション遷移中の適切な選択状態のクリーンアップ。
- 列幅のインテリジェンス: 最小/最大制限付きの実際のコンテンツ幅に基づくスマートな自動サイジング。
- ユーザーエクスペリエンス: スプレッドシートアプリケーションに合わせた一貫した挙動パターン。

### 技術的な改善
- ナビゲーション前に前のセル選択をクリアするようにTabキーハンドラを強化。
- Enter（確定+下に移動）とShift+Enter（改行）機能を分離。
- 一時的なDOM測定によるコンテンツベースの幅計算を実装。
- 80pxの最小幅と400pxの最大幅制約を持つ自動調整機能を追加。
- 適切な選択状態管理で編集モードの遷移を改善。

### テスト
- 包括的なインタラクションテストのためにtest-keyboard-interactions.mdを追加。
- キーボードナビゲーションと列の自動サイジングシナリオのテストカバレッジを強化。

## [0.1.16] - 2025-07-23

### バグ修正
- 長いURLコンテンツの幅の問題: 長いURLや改行されない文字列が設定された制限を超えてセルの幅を広げてしまう重大な問題を修正。
- セル幅の強制: コンテンツのオーバーフローが列幅設定を壊すのを防ぐためにmax-width制約を追加。
- 長いコンテンツのテキスト折り返し: URLや長い文字列を適切に処理するためにword-break:break-allでテキスト折り返しを強化。
- 列リサイズ機能: 長いコンテンツが存在する場合でも列リサイズが正しく機能するように修正。

### 改善
- コンテンツのオーバーフロー処理: 長いURLや改行されない文字列がセルの境界内で適切に折り返されるように。
- 幅の安定性: コンテンツの長さや種類に関わらず、セルの幅が安定して維持されるように。
- ユーザーエクスペリエンス: すべてのコンテンツタイプで列リサイズが一貫して機能。
- レイアウトの整合性: 困難なコンテンツがあってもテーブルレイアウトが構造を維持。

### 技術的な改善
- 幅の制限を強制するためにthとtdの両方の要素にmax-width CSSプロパティを追加。
- コンテンツを収めるために.cell-contentをword-break:break-allとoverflow:hiddenで強化。
- すべてのリサイズ操作にmax-widthを含むようにJavaScriptの幅設定を更新。
- レンダリングパイプライン全体に包括的な幅制約（width, min-width, max-width）を追加。

### テスト
- 様々な長いURLと文字列のシナリオを持つtest-long-url.mdを追加。
- 改行されないコンテンツのエッジケースのテストカバレッジを強化。

## [0.1.15] - 2025-07-23

### バグ修正
- 重大な幅制御の問題: 固定幅のテーブルレイアウトを実装することで、VSCodeウィンドウのリサイズ中にセルの幅が変わる問題を修正。
- テーブルレイアウトの最適化: 自動リサイズを防ぐために、table-layout: fixedから明示的なセル幅を持つtable-layout: autoに変更。
- 幅の永続性: ウィンドウサイズの変更に関わらず、すべてのセルの幅が一定に保たれるように。
- デフォルト幅の管理: デフォルトの列幅の初期化と管理を改善。

### 変更
- テーブル幅の挙動: テーブルの幅を100%からセル幅に基づく自動計算に変更。
- セル幅戦略: すべてのセルがCSSのmin-widthのみに依存するのではなく、明示的な幅の値を持つように。
- リサイズロジック: すべての列幅を一貫して保持するようにウィンドウリサイズ処理を強化。

### 改善
- 安定したレイアウト: ユーザーによって明示的にリサイズされない限り、テーブルレイアウトがウィンドウサイズの変更に反応しないように。
- より良い幅制御: すべてのシナリオでより予測可能で安定した列幅の挙動。
- パフォーマンス: ウィンドウリサイズイベント中の不要なレイアウト再計算を削減。

### 技術的な改善
- テーブルのCSSをwidth: 100%およびtable-layout: fixedからwidth: autoおよびtable-layout: autoに変更。
- すべての列に150pxのデフォルトで明示的な幅の初期化を追加。
- 常に幅の値を含むようにcolumnWidthsの状態管理を強化。
- すべての列幅を維持するようにウィンドウリサイズイベントハンドラを改善。

## [0.1.14] - 2025-07-23

### 変更
- 列ベースの幅制御: より詳細な制御のため、デフォルトの最小幅制御をテーブルレベルから列レベルに変更。
- 列の最小幅の強化: 読みやすさ向上のため、デフォルトの列の最小幅を120pxから150pxに増加。
- 幅管理の改善: ユーザーの操作後、個々の列をデフォルトの最小幅以下にリサイズできるように。
- ウィンドウリサイズの挙動: VSCodeウィンドウのリサイズ時に、既存のセル幅をリセットせずに保持するように。

### 改善
- より良いデフォルトレイアウト: より広いデフォルトの列幅が、より良い初期表示体験を提供。
- 柔軟なリサイズ: ユーザーが初期操作後に列をより小さい幅（最小80px）にリサイズできるように。
- 幅の永続性: ウィンドウリサイズ操作中に列幅が維持される。
- 列ごとの制御: ユーザーの操作に基づいて、各列が異なる最小幅制約を持つことができるように。

### 技術的な改善
- テーブルレベルのmin-widthを列レベルのmin-width制御に置き換え。
- 個々の列のためのuser-resizedクラス管理を追加。
- セルの寸法を保持するようにウィンドウリサイズイベント処理を強化。
- レンダリング関数での列幅の状態管理を改善。

## [0.1.13] - 2025-07-22

### バグ修正
- スクロール位置の保持: セル編集完了後にスクロール位置が一番上にリセットされる重大な問題を修正。
- テーブル再描画の最適化: 不要な完全なDOM再構築を避けるためのインテリジェントな部分更新を実装。
- ソートビューのスクロール維持: ソートビューを適用または復元する際のスクロール位置のリセットを修正。
- 編集位置の可視性: 完了後に編集されたセルの位置に自動スクロールし、ユーザーのコンテキストを維持する機能を追加。

### 改善
- パフォーマンス最適化: 変更されていないテーブル構造に対してコンテンツのみの更新を実装することで、DOM操作を削減。
- ユーザーエクスペリエンス: 編集プロセス全体で視覚的なコンテキストを維持することにより、編集ワークフローを強化。
- スマートレンダリング: 構造的な変更とコンテンツのみの変更を区別するための条件付きレンダリングロジックを導入。

### 技術的な改善
- スクロールを意識したテーブル更新のためにrenderTableWithScrollPreservation()関数を追加。
- 効率的な部分的なコンテンツ更新のためにupdateTableContentOnly()を実装。
- スクロール位置保持機能付きのソート関数を強化。
- 編集完了後のセルへの自動スクロール機能を追加。

### テスト
- スクロール位置保持シナリオのテストカバレッジを強化。
- スクロール維持を伴うソート操作のテストケースを追加。

## [0.1.12] - 2025-07-22

### バグ修正
- セル編集の配置: 編集モードでのテキスト配置を中央揃えから上揃えに修正。
- 編集モードでの自動折り返し: より良いユーザーエクスペリエンスのため、セル編集中に自動テキスト折り返しを有効化。
- 幅の保持: 編集完了後にセルと列の幅がリセットされる問題を修正。
- 列幅の一貫性: 編集後、列ヘッダーが対応するセルと同じ幅を維持するように保証。

### 改善
- テキスト入力の配置: セル入力フィールドが、表示モードに合わせてテキストを左上に正しく配置するように。
- Textareaの処理: 適切な折り返しを持つ複数行コンテンツのためのtextarea設定を強化。
- 寸法の永続性: 編集プロセス全体を通じてセルと列の寸法が維持されるように。

### 技術的な改善
- 編集モードでの適切なテキスト配置のためにCSSを更新。
- セルの寸法を保持するためにstartCellEdit()関数を強化。
- 幅設定を維持するためにcommitCellEdit()とcancelCellEdit()を改善。
- 入力フィールドに適切な垂直方向の配置とテキスト折り返しを追加。

### テスト
- セル編集の配置と折り返しのための新しいテストファイルを追加。
- 配置と寸法の保持テストで既存のテストスイートを強化。

## [0.1.11] - 2025-07-22

### バグ修正
- HTML改行タグの表示: <br/>タグが表示時に改行に正しく変換されない問題を修正。
- 改行タグの処理: HTML改行タグの変換を正しく処理するようにprocessCellContent()関数を改善。
- HTMLエスケープ: 他のHTMLコンテンツをエスケープしつつ改行タグを保持するようにescapeHtmlExceptBreaks()を強化。
- デバッグログ: 改行タグ処理のトラブルシューティングのために一時的なデバッグログを追加。

### 技術的な改善
- HTML改行タグの表示レンダリングを修正。
- セルコンテンツ処理パイプラインを改善。
- 改行タグのためのHTMLエスケープ論理を強化。

## [0.1.10] - 2025-07-22

### エンハンス
- HTML改行タグのサポート: <br/>タグの自動検出と改行への変換。
- 双方向のタグ処理: 編集と保存のためのHTMLタグと改行間のシームレスな変換。
- セルコンテンツ処理の改善: 表示、編集、保存形式の処理を強化。
- より良い複数行編集: 適切なHTMLタグサポートによる自然な編集体験。
- ソートの強化: HTMLタグを認識する比較によるソート挙動の改善。

### 技術的な改善
- 表示形式変換のためにprocessCellContent()を追加。
- 編集形式変換のためにprocessCellContentForEditing()を追加。
- 保存形式変換のためにprocessCellContentForStorage()を追加。
- HTML改行タグを処理するようにソートアルゴリズムを改善。
- 適切なタグから改行への変換でセルレンダリングを強化。

## [0.1.9] - 2025-07-22

### エンハンス
- 適応的なセル編集: テキスト入力フィールドがセルのサイズと内容に自動的に調整されるように。
- 複数行サポート: textareaによる複数行コンテンツの自動検出と処理。
- 動的な入力サイズ調整: コンテンツとセルの寸法に基づいて入力フィールドが動的にリサイズ。
- 自然な編集体験: 単一行入力と複数行textarea間のシームレスな移行。
- キーボードナビゲーションの改善: 異なる入力タイプに対するTabナビゲーションとEnterキーの処理を強化。

### 技術的な改善
- より良い視覚的配置のための入力フィールドの配置とサイズ計算。
- コンテンツに基づくtextareaの自動リサイズ機能。
- inputとtextarea両方の要素のCSSスタイリングを改善。
- 異なる入力タイプのイベント処理を強化。

## [0.1.8] - 2025-07-22

### 追加
- ビューのみのソート: テーブルのソートがデフォルトでビューのみモードで動作するように。
  - ソートが自動的にファイルを変更しなくなる。
  - データが一時的にソートされているときに視覚的なインジケータを表示。
  - ファイルの順序に戻るための「元の順序に戻す」ボタン。
  - ソートの変更を永続化するための「ソートをファイルに保存」ボタン。
  - ステータスバーが現在のソート状態（ビューのみ vs 保存済み）を表示。
- 強化されたソートコントロール: ソートされたデータを表示しているときにソートアクションパネルが表示される。
- 数値ソートのサポート: 数値データを適切に処理する改善されたソートアルゴリズム。
- ソート状態管理: 元のデータとソートされたデータの状態のより良い追跡。

### 変更
- デフォルトのソート挙動: 列ヘッダーのクリックが、すぐに保存するのではなく、ビューのみのソートを適用するように。
- ソートの視覚的インジケータ: ビューのみのソートとコミットされたソートを区別するための強化されたスタイリング。
- データの安全性: 明示的に保存されない限り、元のテーブルの順序が保持される。

### 改善
- ユーザーコントロール: ユーザーがソートの変更をファイルに永続化するタイミングを選択できるように。
- データ整合性: テーブルデータの偶発的な永続的なソートを防止。
- 視覚的フィードバック: 一時的なソート状態と永続的なソート状態の明確な表示。

## [0.1.7] - 2025-07-22

### バグ修正
- 列リサイズイベントの処理: リサイズとソート操作間のイベント分離を改善。
  - リサイズハンドルのmousedownイベントにevent.stopPropagation()を追加。
  - クリックイベントの干渉を防ぐためにリサイズ状態管理を強化。
  - 列をリサイズすると不要なソート操作がトリガーされる問題を修正。

### 追加
- テストファイル: リサイズとソート機能のための包括的なテストファイルを追加。

### 改善
- イベントハンドリング: テーブルヘッダーでのマウスおよびクリックイベントのより正確な制御。
- ユーザーエクスペリエンス: 列のリサイズが他の操作と干渉せずに機能するように。

## [0.1.6] - 2025-07-21

### 追加
- UI/UXの強化: 使いやすさ向上のための主要なインターフェース改善。
  - 下部ステータスバー: エラーと保存メッセージが下部に表示されるように。
  - 簡素化されたツールバー: 保存、エクスポート、行削除、列削除ボタンを削除。
  - コンテキストメニュー中心: すべての行/列操作が右クリックのコンテキストメニューを使用するように。
  - スマートフォーカス管理: 別のセルを選択するとセル編集が自動的にコミットされる。
  - 入力処理の改善: テキスト入力のクリックとフォーカスの処理を改善。

### 変更
- メッセージシステム: すべてのステータスメッセージを、邪魔にならないフィードバックのために下部ステータスバーに移動。
- コマンド構造: 集中した編集体験のために「新規テーブル作成」コマンドを削除。
- インターフェースレイアウト: UIの乱雑さを最小限に抑えた、よりクリーンなワークスペース。

### 改善
- 編集体験: より良いフォーカス管理でセル編集を強化。
- イベント伝播: 編集中キーボードとマウスイベントのより良い制御。
- テーマ統合: すべてのUI要素がVSCodeのテーマカラーを適切に使用するように。

## [0.1.5] - 2025-07-21

### 追加
- 複数テーブルのサポート: 複数テーブルを持つドキュメントの完全なサポート。
  - テーブル選択ダイアログ: 直感的なQuickPickダイアログから編集するテーブルを選択。
  - テーブルインデックス追跡: 正確な更新のために各テーブルをインデックスで追跡。
  - 混合コンテンツの互換性: コードブロック、リストなどを含むドキュメントを安全に処理。

### エンハンス
- Markdownパーサー: 実際のテーブルとテーブルのようなコンテンツを区別する高度なAST解析。
- ファイルハンドラ: 他のすべてのドキュメントコンテンツを保持するインデックスベースのテーブル更新。
- エラーハンドリング: 包括的な検証と回復オプション。
- テーブル選択UI: テーブルの場所、ヘッダー、サイズ、コンテンツのプレビューを表示。

### バグ修正
- テーブル位置の精度: 正確な行範囲の計算がコンテンツの破損を防止。
- コンテンツの保持: 更新中にすべての非テーブルコンテンツが保持される。
- テーブルの識別: 複雑なドキュメントでのテーブル境界の正確な検出。

## [0.1.0] - 2025-07-20

### 追加
- 初回リリース: スプレッドシートのようなMarkdownテーブルエディタ。
- 基本編集: キーボードナビゲーションによるセル編集。
- テーブル操作: 行と列の追加/削除。
- ソート: 列ヘッダーをクリックしてデータをソート。
- ドラッグ＆ドロップ: 行と列の並べ替え。
- 自動保存: 変更をMarkdownファイルに自動的に保存。
- VSCode統合: コンテキストメニューとコマンドパレットの統合。

### 機能
- テーブル編集のためのExcelのようなグリッドインターフェース。
- キーボードナビゲーション（矢印、Tab、Enter）。
- 行と列のコンテキストメニュー操作。
- リアルタイムのテーブル操作。
- 自動更新付きのMarkdownファイル統合。
