# Markdown Table Editor VSCode Extension

Always reference these instructions first and fallback to search or bash commands only when you encounter unexpected information that does not match the info here.

## Working Effectively

**CRITICAL: NEVER CANCEL any build or test commands.** Builds may take 10+ minutes, tests may take 15+ minutes. Always use appropriate timeouts.

### Bootstrap and Build
- Install dependencies: `npm install` -- takes 30-45 seconds depending on network speed
- Compile TypeScript and copy files: `npm run compile` -- takes 5-10 seconds. NEVER CANCEL. Set timeout to 60+ seconds.
- Lint code: `npm run lint` -- takes 2-5 seconds. May show warnings but should not have errors
- Package extension: `npx vsce package` -- takes 8-15 seconds. NEVER CANCEL. Set timeout to 60+ seconds.

### Development Workflow 
- **FASTEST DEVELOPMENT**: Use `npm run dev` for instant HTML/CSS/JS iteration
  - Start server: `npm run dev` -- starts instantly
  - Open browser: `http://localhost:3000/` (NOT /dev/ - that returns 404)
  - Edit files in `webview/` folder and refresh browser to see changes
  - Alternative: `npm run dev:watch` for file change monitoring
- **VSCode Extension Development**: Use F5 in VSCode to launch Extension Development Host
  - Requires VSCode to be running
  - Slower iteration cycle but tests real VSCode integration

### Testing
**NOTE: Standard test commands fail in this environment due to VSCode download restrictions**
- Unit tests: `npm test` -- FAILS due to VSCode test environment requirements
- Integration tests: `npm run test:integration` -- FAILS due to network restrictions  
- **WORKING TESTS**:
  - Interface demo: `node test/interface-demo.js` -- validates test infrastructure
  - Core module verification: `node verify-core-module.js` -- checks module system

## Validation

**ALWAYS manually validate changes using the development server:**

1. **Start Development Server**: `npm run dev`
2. **Open Browser**: Navigate to `http://localhost:3000/`
3. **Test Basic Functionality**:
   - Click "Load Sample" button to load test data
   - Verify table renders with 3 rows and 3 columns
   - Click on cells to test editing functionality
   - Test row/column operations via right-click context menus
   - Test sorting by clicking column headers
   - Test CSV export functionality
4. **Test Development Controls**:
   - Use "Sample Data" dropdown to test different table types
   - Click "Debug State" to inspect console output
   - Monitor console for errors or warnings

**VALIDATION SCENARIOS**: Always test these user flows after making changes:
- **Table Loading**: Load sample data and verify table renders correctly
- **Cell Editing**: Click a cell, type new content, press Enter to confirm
- **Row Operations**: Right-click row number, add/delete rows
- **Column Operations**: Right-click column header, add/delete columns  
- **Sorting**: Click column header to sort, verify data order changes
- **Export**: Click "Export CSV" and verify download works

### Code Quality
- Always run `npm run lint` before committing changes
- Fix any new linting errors (warnings are acceptable)
- The codebase has 17 existing linting warnings - do not worry about these unless you're editing the affected files

## Common Tasks

### Repository Structure
```
├── .github/                  # GitHub configuration (you're here!)
├── .vscode/                  # VSCode settings and launch configs  
├── dev/                      # Development server files
│   ├── start-dev-server.js   # Development server script
│   └── index.html            # Development page template
├── out/                      # Compiled output (generated by npm run compile)
├── src/                      # TypeScript source code
│   ├── extension.ts          # Main extension entry point
│   ├── webviewManager.ts     # Webview management
│   ├── tableDataManager.ts   # Table data handling
│   └── ...                   # Other TypeScript modules
├── test/                     # Test files and mocks
├── webview/                  # Frontend HTML/CSS/JS
│   ├── tableEditor.html      # Main webview HTML
│   ├── style.css             # Styles
│   └── js/                   # JavaScript modules
├── package.json              # NPM configuration and scripts
└── tsconfig.json             # TypeScript configuration
```

### Key Files to Know
- **package.json**: Contains all npm scripts and dependencies
- **src/extension.ts**: Main VSCode extension entry point
- **src/webviewManager.ts**: Manages webview lifecycle and communication
- **webview/tableEditor.html**: Main UI for table editing
- **webview/js/core.js**: Core table editor module system
- **DEVELOPMENT.md**: Quick development setup guide
- **README.md**: User documentation with development section

### NPM Scripts Reference
```bash
npm run compile        # Compile TS + copy webview files (5-10s)
npm run watch          # Watch mode for development 
npm run lint           # Run ESLint (2-5s)
npm run dev            # Start development server (instant)
npm run dev:watch      # Development server with file watching
npm test               # Run unit tests (FAILS in this environment)
npm run test:integration  # Integration tests (FAILS in this environment)
npm run vscode:prepublish # Pre-publish build step
```

### Development Tips
- **Edit HTML/CSS/JS**: Use `npm run dev` + browser refresh for fastest iteration
- **Edit TypeScript**: Must run `npm run compile` to see changes in VSCode extension
- **Debugging**: Use browser DevTools when testing with development server
- **Module System**: The codebase uses a custom modular architecture - see `webview/js/core.js`
- **Error Handling**: Check browser console for detailed error messages and logs

### Build Timing Expectations
- **npm install**: 30-45 seconds (network dependent) - NEVER CANCEL
- **npm run compile**: 5-10 seconds - NEVER CANCEL  
- **npm run lint**: 2-5 seconds
- **npx vsce package**: 8-15 seconds - NEVER CANCEL
- **npm run dev**: Instant startup

### Known Issues and Workarounds
- VSCode test environment cannot be downloaded in this sandboxed environment
- Use development server (`npm run dev`) for comprehensive testing instead
- Linting shows 17 warnings but no errors - this is normal
- Development server serves root at `http://localhost:3000/` not `/dev/`

### When Things Go Wrong
1. **Compilation Errors**: Check TypeScript syntax in `src/` files
2. **Runtime Errors**: Test in development server and check browser console
3. **Module Issues**: Run `node verify-core-module.js` to check module system
4. **Build Failures**: Ensure all dependencies are installed with `npm install`

Always ensure changes work in the development environment before proceeding with VSCode extension testing.